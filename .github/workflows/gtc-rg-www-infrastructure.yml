on:
  push:
    branches:
    - '*'
    paths:
    - .azure/*
    - .github/workflows/*

env:  
  companyInfix: 'gtc'
  coutnerInfix: '001'
  productInfix: 'www'
  rgLocation: 'westus2'
  subscriptionService: AZURE_SERVICE_CONNECTION
  infrastructurePath: ${{ github.workspace }}/.azure
  environment: ${{ <expression> }} development
  subscriptionId: ${{ secrets.SUBSCRIPTION_ID }}
  environmentInfix: 'dev'

jobs:
  deploy_landing_zone:
    uses: ./.github/workflows/landingzone-infrastructure-steps.yml
    with:
      armPath: ${{ env.infrastructurePath }}
      armSuffix: 'bicep'
      rgName: '${{ env.companyInfix }}-rg-${{ env.productInfix }}-${{ env.environmentInfix }}-${{ env.coutnerInfix }}'
      rgLocation: ${{ env.rgLocation }}
      appiName: 'appi-${{ env.productInfix }}-${{ env.environmentInfix }}-${{ env.coutnerInfix }}'
      kvName: 'kv-${{ env.productInfix }}-${{ env.environmentInfix }}-${{ env.coutnerInfix }}'
      stName: 'st-${{ env.productInfix }}-${{ env.environmentInfix }}-${{ env.coutnerInfix }}'
      workName: 'work-${{ env.productInfix }}-${{ env.environmentInfix }}-${{ env.coutnerInfix }}'
    secrets: inherit
